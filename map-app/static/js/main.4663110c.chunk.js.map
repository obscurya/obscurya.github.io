{"version":3,"sources":["store/points/reducers.js","store/map/reducers.js","store/reducers.js","store/map/actions.js","components/Map.js","components/Table.js","store/points/actions.js","App.js","index.js"],"names":["initialState","points","activePoint","center","fromLonLat","zoom","combineReducers","state","action","type","payload","map","setMapView","restoreMapView","Map","olmap","this","OlMap","target","layers","OlLayerTile","source","OlSourceOSM","view","OlView","props","controls","OlZoom","on","getView","getCenter","getZoom","JSON","stringify","prevProps","length","getOverlays","clear","name","getOverlayById","id","element","childNodes","className","forEach","point","document","createElement","innerHTML","marker","OlOverlay","position","lon","lat","positioning","stopEvent","addOverlay","setCenter","setZoom","style","width","height","Component","mapDispatchToProps","connect","Table","setActivePoint","index","key","onClick","toFixed","App","clearPoints","bind","addPoints","disabled","store","createStore","rootReducer","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.4663110c.chunk.js","sourcesContent":["const initialState = {\r\n  points: [],\r\n  activePoint: {}\r\n};\r\n\r\nexport default (state = initialState, action) => {\r\n  switch (action.type) {\r\n    case 'ADD_POINTS':\r\n      return { ...state, points: action.payload };\r\n    case 'CLEAR_POINTS':\r\n      return initialState;\r\n    case 'SET_ACTIVE_POINT':\r\n      return { ...state, activePoint: action.payload };\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","import { fromLonLat } from 'ol/proj';\r\n\r\nconst initialState = {\r\n  center: fromLonLat([30.342656, 59.926291]),\r\n  zoom: 12\r\n};\r\n\r\nexport default (state = initialState, action) => {\r\n  switch (action.type) {\r\n    case 'SET_MAP_VIEW':\r\n      return action.payload;\r\n    case 'RESTORE_MAP_VIEW':\r\n      return initialState;\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","import { combineReducers } from 'redux';\r\n\r\nimport points from './points/reducers';\r\nimport map from './map/reducers';\r\n\r\nexport default combineReducers({ points, map });\r\n","export const setMapView = (center, zoom) => ({\r\n  type: 'SET_MAP_VIEW',\r\n  payload: { center, zoom }\r\n});\r\n\r\nexport const restoreMapView = () => ({\r\n  type: 'RESTORE_MAP_VIEW',\r\n  payload: null\r\n});\r\n","import React, { Component } from 'react';\r\nimport OlMap from 'ol/Map';\r\nimport OlView from 'ol/View';\r\nimport OlZoom from 'ol/control/Zoom';\r\nimport OlOverlay from 'ol/Overlay';\r\nimport OlLayerTile from 'ol/layer/Tile';\r\nimport OlSourceOSM from 'ol/source/OSM';\r\nimport { fromLonLat } from 'ol/proj';\r\nimport { connect } from 'react-redux';\r\n\r\nimport { setMapView, restoreMapView } from '../store/map/actions';\r\n\r\nclass Map extends Component {\r\n  olmap = null;\r\n\r\n  componentDidMount() {\r\n    this.olmap = new OlMap({\r\n      target: 'map',\r\n      layers: [new OlLayerTile({ source: new OlSourceOSM() })],\r\n      view: new OlView({\r\n        center: this.props.center,\r\n        zoom: this.props.zoom\r\n      }),\r\n      controls: [new OlZoom()]\r\n    });\r\n\r\n    this.olmap.on('moveend', () => {\r\n      const center = this.olmap.getView().getCenter();\r\n      const zoom = this.olmap.getView().getZoom();\r\n\r\n      if (JSON.stringify(center) !== JSON.stringify(this.props.center) || zoom !== this.props.zoom)\r\n        this.props.setMapView(center, zoom);\r\n    });\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    if (prevProps.points.length && !this.props.points.length) {\r\n      this.olmap.getOverlays().clear();\r\n    } else if (JSON.stringify(prevProps.activePoint) !== JSON.stringify(this.props.activePoint)) {\r\n      if (prevProps.activePoint.name)\r\n        this.olmap.getOverlayById(prevProps.activePoint.id).element.childNodes[0].className = 'map-marker';\r\n\r\n      if (this.props.activePoint.name)\r\n        this.olmap.getOverlayById(this.props.activePoint.id).element.childNodes[0].className =\r\n          'map-marker map-marker-active';\r\n    }\r\n\r\n    if (!prevProps.points.length && this.props.points.length) {\r\n      this.props.points.forEach(point => {\r\n        let element = document.createElement('div');\r\n\r\n        element.className = 'map-marker';\r\n        element.innerHTML = `<div class=\"pin\"></div><p>${point.id}</p>`;\r\n\r\n        let marker = new OlOverlay({\r\n          id: point.id,\r\n          position: fromLonLat([point.lon, point.lat]),\r\n          positioning: 'center-center',\r\n          element,\r\n          stopEvent: false\r\n        });\r\n\r\n        this.olmap.addOverlay(marker);\r\n      });\r\n    }\r\n  }\r\n\r\n  render() {\r\n    if (this.olmap) {\r\n      this.olmap.getView().setCenter(this.props.center);\r\n      this.olmap.getView().setZoom(this.props.zoom);\r\n    }\r\n\r\n    return (\r\n      <div className=\"main-map\">\r\n        <div id=\"map\" style={{ width: '100%', height: '100%' }}></div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n  points: state.points.points,\r\n  activePoint: state.points.activePoint,\r\n  center: state.map.center,\r\n  zoom: state.map.zoom\r\n});\r\n\r\nconst mapDispatchToProps = {\r\n  setMapView,\r\n  restoreMapView\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Map);\r\n","import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { fromLonLat } from 'ol/proj';\r\n\r\nimport { setActivePoint } from '../store/points/actions';\r\nimport { setMapView, restoreMapView } from '../store/map/actions';\r\n\r\nclass Table extends Component {\r\n  setActivePoint(point) {\r\n    if (JSON.stringify(this.props.activePoint) === JSON.stringify(point)) {\r\n      this.props.setActivePoint({});\r\n      this.props.restoreMapView();\r\n    } else {\r\n      this.props.setActivePoint(point);\r\n      this.props.setMapView(fromLonLat([point.lon, point.lat]), 17);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"main-table\">\r\n        <h2>Points</h2>\r\n        <div className=\"table\">\r\n          <div className=\"table-header\">\r\n            <div className=\"table-header-item\">ID</div>\r\n            <div className=\"table-header-item\">Name</div>\r\n            <div className=\"table-header-item\">Lat</div>\r\n            <div className=\"table-header-item\">Lon</div>\r\n          </div>\r\n          {this.props.points.map((point, index) => (\r\n            <div\r\n              className={`table-row${point.id === this.props.activePoint.id ? ' table-row-active' : ''}`}\r\n              key={index}\r\n              onClick={() => this.setActivePoint(point)}\r\n            >\r\n              <div className=\"table-row-item\">{point.id}</div>\r\n              <div className=\"table-row-item\">{point.name}</div>\r\n              <div className=\"table-row-item\">{point.lat.toFixed(6)}</div>\r\n              <div className=\"table-row-item\">{point.lon.toFixed(6)}</div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => ({\r\n  points: state.points.points,\r\n  activePoint: state.points.activePoint\r\n});\r\n\r\nconst mapDispatchToProps = {\r\n  setActivePoint,\r\n  setMapView,\r\n  restoreMapView\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Table);\r\n","export const addPoints = points => ({\r\n  type: 'ADD_POINTS',\r\n  payload: points\r\n});\r\n\r\nexport const clearPoints = () => ({\r\n  type: 'CLEAR_POINTS',\r\n  payload: null\r\n});\r\n\r\nexport const setActivePoint = point => ({\r\n  type: 'SET_ACTIVE_POINT',\r\n  payload: point\r\n});\r\n","import React, { Component } from 'react';\nimport { connect } from 'react-redux';\n\nimport { addPoints, clearPoints } from './store/points/actions';\nimport { restoreMapView } from './store/map/actions';\n\nimport Map from './components/Map';\nimport Table from './components/Table';\n\nimport './App.css';\nimport 'ol/ol.css';\nimport './css/Map.css';\nimport './css/Table.css';\n\nconst points = [\n  {\n    id: 1,\n    name: 'Петропавловский собор',\n    lat: 59.950137,\n    lon: 30.316023\n  },\n  {\n    id: 2,\n    name: 'Ботанический сад СПбГУ',\n    lat: 59.94148,\n    lon: 30.296796\n  },\n  {\n    id: 3,\n    name: 'Эрмитаж',\n    lat: 59.939881,\n    lon: 30.314562\n  },\n  {\n    id: 4,\n    name: 'Домик Петра I',\n    lat: 59.953326,\n    lon: 30.330843\n  },\n  {\n    id: 5,\n    name: 'Севкабель порт',\n    lat: 59.924599,\n    lon: 30.241717\n  },\n  {\n    id: 6,\n    name: 'Ивановский карьер',\n    lat: 59.878167,\n    lon: 30.424\n  }\n];\n\nclass App extends Component {\n  clearPoints() {\n    this.props.clearPoints();\n    this.props.restoreMapView();\n  }\n\n  render() {\n    return (\n      <div className=\"app\">\n        <div className=\"header\" onClick={this.clearPoints.bind(this)}>\n          <h1>Map App</h1>\n        </div>\n        <div className=\"container\">\n          <div className=\"side\">\n            <button className=\"button\" onClick={() => this.props.addPoints(points)} disabled={this.props.points.length}>\n              ADD POINTS\n            </button>\n          </div>\n          <div className=\"main\">\n            <Map />\n            <Table />\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = state => ({\n  points: state.points.points\n});\n\nconst mapDispatchToProps = {\n  addPoints,\n  clearPoints,\n  restoreMapView\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(App);\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n// import { createStore, applyMiddleware } from 'redux';\nimport { createStore } from 'redux';\nimport { Provider } from 'react-redux';\n// import logger from 'redux-logger';\n\nimport rootReducer from './store/reducers';\nimport App from './App';\n\nimport './css/index.css';\n\n// const store = createStore(rootReducer, applyMiddleware(logger));\nconst store = createStore(rootReducer);\n\nReactDOM.render(\n  <Provider store={store}>\n    <App />\n  </Provider>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}